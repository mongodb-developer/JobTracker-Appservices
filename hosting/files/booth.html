<!doctype html>
<html>

<head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        .hotspot {  z-index: 100; position: absolute;width: 20px; height:20px; border-radius: 50%; border: 1px solid red}
        .wrapper {position: relative; border: 1px sold green;}
        .img-fluid { margin: 0 auto; max-height: 95vh; }
       
    </style>
    <script>

        const firstimage = "login"
        const images = {login:"applogin.png",main:"appimg.png"}
        const hotspots=[ { img:"login",x:50,y:70,action:"main"},
                           {img: "main", x:90,y:10,action:"login"},
            {img: "main", x:50,y:50,action:`https://github.com/mongodb-developer/Job-Tracker/blob/master/shared/src/commonMain/kotlin/com/mongodb/jobtracker/Models.kt`},
                   {img:"main",x:50,y:80,action:`https://github.com/mongodb-developer/Job-Tracker/blob/master/shared/src/commonMain/kotlin/com/mongodb/jobtracker/RealmRepo.kt`}];

        
        function hsclick(action) {
            console.log(action);
            if(action.startsWith("http")) {
                //Link to Code
            let holder = document.getElementById("codeholder")
            let newholder = document.createElement('div')
            newholder.setAttribute('id','codeholder')
            holder.parentNode.replaceChild( newholder,holder); 
           
            let newscript = document.createElement('script')
            newholder.appendChild(newscript);
            let url = `https://emgithub.com/embed-v2.js?target=${encodeURI(action)}&style=default&type=code&showBorder=on&showLineNumbers=on&showFileMeta=on&showFullPath=on&showCopy=on`
            newscript.setAttribute("src",url);
            } else {
                screenshot = document.getElementById("screenshot")
                screenshot.src = images[action];
                drawHotspots(action)
            }
        }

        function drawHotspots(name)
        {
            image = document.getElementById("imgwrapper")
            //Remove existing
            const existingHotspots = image.getElementsByClassName("hotspot")
        
            //Easy way to remove all in a live list
            while (existingHotspots.length > 0){
                existingHotspots[0].remove();
            }
      
             for(hotspot of hotspots) {
                if(hotspot.img == name) {
                   
                    newelement = document.createElement('div')
                    newelement.setAttribute('class','hotspot')
                    newelement.setAttribute('class','hotspot')
                    image.appendChild(newelement);
                    newelement.style.top = `${hotspot.y}%`;
                    newelement.style.left = `${hotspot.x}%`;
                    console.log(`Add: ${hotspot.action}`);
                    newelement.addEventListener('click',hsclick.bind(null,hotspot.action))
                }
            }
        }

        function onLoad() {
            //Set image tyo first image
            screenshot = document.getElementById("screenshot")
            screenshot.src = images[firstimage];
            drawHotspots(firstimage)
           
        }
    </script>

</head>

<body onLoad="onLoad()">
    <div class="container-fluid">
        <div class="row">
            <div class="col">
                    <iframe style="height: 95vh; width: 100%" src="/index.html"></iframe>
                
            </div>  
            <div class="col bg-dark">
                <div id="codeholder">
                    <script style="height: 90vw; width: 90vw;" id="codeframe" ></script>
                </div>
            </div>
            <div class="col">
                <div id="imgwrapper" class="wrapper text-center">
                <img id="screenshot" src="" class="img-fluid screenshot"></img>
                </div>
            </div>
        </div>
    </div>

</body>

</html>